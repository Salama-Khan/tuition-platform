<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>Review Submission</title>
<script src="https://cdn.tailwindcss.com"></script></head>
<body class="p-6">
  <h1 class="text-2xl font-semibold mb-4">Review Submission</h1>

  <div class="border rounded p-4">
    <div class="font-medium">{{ sub.task.title }} — {{ sub.task.subject.name }}</div>
    <div class="text-sm text-gray-600">
      Student: {{ sub.student.username }} • Submitted: {{ sub.submitted_at }}
    </div>
    <div class="mt-2">
      <a class="text-sm underline" href="{{ sub.file.url }}" target="_blank" rel="noopener">Download file</a>
      {% if sub.locked %}
        <span class="ml-2 text-xs px-2 py-1 rounded bg-gray-200 text-gray-800">locked</span>
      {% endif %}
    </div>
  </div>

  <form method="post" class="mt-4 space-y-3">
    {% csrf_token %}
    <label class="block">
      <span class="text-sm">Feedback</span>
      <textarea name="feedback_text" class="border rounded p-2 w-full" rows="5">{{ sub.feedback_text }}</textarea>
    </label>
    <label class="flex items-center gap-2">
      <input type="checkbox" name="lock" {% if sub.locked %}checked{% endif %}>
      <span>Lock submission (prevent resubmission)</span>
    </label>
    <button class="px-4 py-2 rounded bg-black text-white">Save</button>
  </form>

  <p class="mt-3 text-sm">
    <a class="underline" href="{% url 'teacher_submissions' %}">Back to submissions</a>
  </p>
</body>
</html>
